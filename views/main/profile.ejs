<%- include('../partials/header.ejs') %>
<% if (user) { %>
    <h3>Welcome, <%= user.firstName + " " + user.lastName + " (" + user.username + ")" %></h3>
    <% if (user.gamesCreated) { %>
        <h3>Search:</h3>
        <form action="/search" method="POST">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required>
            <button>Search</button>
        </form>
        <h3>Games Created:</h3>
        <% for (var i = 0; i < user.gamesCreated.length; i++) { %>
            <% if (i % 6 == 0 && i != 0) { %>
                <br><br>
            <% } %>
            <div class='sideAdjust'>
                <div class='itemAdjust'>
                    <p><%= user.gamesCreated[i].title %></p>
                    <div class='thumbnail'>
                        <iframe frameBorder='0' src='/thumbnail/<%= user.gamesCreated[i]._id %>'></iframe>
                    </div>
                    <form>
                        <button formmethod="GET" formaction="/editor/<%= user.gamesCreated[i]._id %>">Edit</button>
                        <button formmethod="GET" formaction="/preview/<%= user.gamesCreated[i]._id %>">Preview</button>
                        <button type="submit" formmethod="POST" formaction="/delete/<%= user.gamesCreated[i]._id %>?_method=DELETE">Delete</button>
                    </form>
                    <br>
                </div>
            </div>
        <% } %>
    <% } %>
    <h3>Games Played:</h3>
    <% if (user.gamesPlayed.length) { %>
        <% user.gamesPlayed.forEach(game => { %>
            <a href='/games/<%= game._id %>'><p><%= game.title %></p></a>
        <% }); %>
    <% } else { %>
        <h3>Function is still in development, check back later</h3>
    <% } %>
<% } else { %>
    <h3>Please log into your account to use this section of the application</h3>
<% } %>